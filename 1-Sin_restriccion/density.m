function d = density(MP)

if size(MP,2) == 6
    d = density_3P(MP);
elseif size(MP,2) == 7
    d = density_4P(MP);
else
    d = 0;
end

end

function d = density_3P(MP)
x1 = MP(:,1);
x2 = MP(:,2);
x3 = MP(:,3);

% Coeficientes
c1 =    -1.580470233540865e+00;
c2 =     5.553755378932029e-01;
c3 =     1.014332398351462e+00;
c4 =     8.473896474354787e-01;
c5 =    -1.164569988839370e-01;
c6 =     2.038221879953645e-02;
c7 =     1.636104344396123e-01;
c8 =    -2.080441333094435e-01;
c9 =     3.038811288149539e-01;

% Polinomio
d = c4*x1 + c7*x2 + c9*x3 + c1*x1.^2 + c5*x2.^2 + c8*x3.^2 + c2*x1.*x2 + ...
          c3*x1.*x3 + c6*x2.*x3;
end

function d = density_4P(MP)
x1 = MP(:,1);
x2 = MP(:,2);
x3 = MP(:,3);
x4 = MP(:,4);

% Coeficientes
c0001 = 1.12833182559186350000;
c0002 = -0.91827873072997968000;
c0003 = -0.33225978697527209000;
c0004 = 0.00000185184617607381;
c0005 = -3.14725240187325060000;
c0006 = 2.55751676819985980000;
c0007 = -2.23261230189122670000;
c0008 = -0.00000388988083070878;
c0009 = -0.46597623982088043000;
c0010 = -0.75495312930818315000;
c0011 = 0.00000540304821248170;
c0012 = 4.99368139330651490000;
c0013 = -0.00518275991831394340;
c0014 = 0.01036113223682506200;
c0015 = 3.20361039906701480000;
c0016 = -4.03894744498663720000;
c0017 = 2.44950702067614400000;
c0018 = 0.00000775137782133127;
c0019 = 5.44330539599272270000;
c0020 = 1.37984574874719290000;
c0021 = -0.00000803278107488130;
c0022 = -4.44623824856522010000;
c0023 = 0.00130846665217404400;
c0024 = -0.00261768036528807130;
c0025 = -2.87153300067969570000;
c0026 = 0.31423864525339912000;
c0027 = 0.00000238435556694673;
c0028 = -1.10089332299687180000;
c0029 = 0.00273258623932732140;
c0030 = -0.00546869195752159970;
c0031 = -1.09220898568414420000;
c0032 = 0.00000944476256326744;
c0033 = 0.00416090698533552830;
c0034 = -0.00834744618536001170;
c0035 = -2.97414959124237170000;
c0036 = 1.42153171107662830000;
c0037 = 0.07927849872495711100;
c0038 = -0.00000539800668381624;
c0039 = -2.49488863984962660000;
c0040 = -2.07244173247331040000;
c0041 = -0.00000234608243380619;
c0042 = 1.72179006645681150000;
c0043 = -0.00050821390296201807;
c0044 = 0.00102520918601866060;
c0045 = 0.03316499759326260700;
c0046 = 0.74038190332631837000;
c0047 = 0.00000273566476710412;
c0048 = 0.88669736181120795000;
c0049 = 0.00104291753993642610;
c0050 = -0.00208306130881187510;
c0051 = -0.83717960180920326000;
c0052 = 0.00000523311634945897;
c0053 = -0.00103822655772520490;
c0054 = 0.00205367799016721800;
c0055 = 2.17946621773413530000;
c0056 = -1.12171081327859650000;
c0057 = -0.00000700637958334063;
c0058 = 2.19958412619249130000;
c0059 = -0.00029783860150103347;
c0060 = 0.00060699167475139276;
c0061 = -3.49726771124945210000;
c0062 = 0.00000675216647961940;
c0063 = -0.00244006340358603230;
c0064 = 0.00485231715243504900;
c0065 = 4.64312389111927890000;
c0066 = -0.00992792893544305890;
c0067 = 0.03969732623213476800;
c0068 = -0.05860263132488391400;
c0069 = 0.03782849124218065600;
c0070 = 0.00870068802486318250;
c0071 = -0.25382708630704853000;
c0072 = -0.09473041207382401600;
c0073 = -0.00000346038821550954;
c0074 = 0.59995769988364323000;
c0075 = 0.25831760412194477000;
c0076 = -0.00000563634119928991;
c0077 = -0.02970820543601394500;
c0078 = 0.00020435908963966845;
c0079 = -0.00039691887699100045;
c0080 = -0.47373618768498144000;
c0081 = 0.18536375373504826000;
c0082 = -0.00000592952631926879;
c0083 = -0.60892972742188867000;
c0084 = -0.00003780234007861612;
c0085 = 0.00009259408750864509;
c0086 = 0.26378972065607059000;
c0087 = -0.00005971542361711116;
c0088 = -0.00004742467820245060;
c0089 = 0.00026568379002063768;
c0090 = 0.13388839163049154000;
c0091 = -0.17600747579494022000;
c0092 = -0.00000700476915617524;
c0093 = 0.17614391359811069000;
c0094 = -0.00001184142073260743;
c0095 = 0.00004242231080676861;
c0096 = 0.13837219948051011000;
c0097 = -0.00007494553067100931;
c0098 = 0.00002081090173831879;
c0099 = 0.00017181878986550201;
c0100 = -0.11329080838264699000;
c0101 = 0.00166125815427280920;
c0102 = -0.00652669061990932430;
c0103 = 0.00971124374371530770;
c0104 = -0.00649177858914260120;
c0105 = -0.00486366148154745730;
c0106 = 0.12584811091303183000;
c0107 = -0.00000379030907728875;
c0108 = -0.22048267768611404000;
c0109 = 0.00015479999869166111;
c0110 = -0.00029637133861938451;
c0111 = 0.12906183023804380000;
c0112 = -0.00006023179092872005;
c0113 = -0.00002369728687494770;
c0114 = 0.00021827837448821989;
c0115 = -0.03925794615391214200;
c0116 = 0.00349692363638423600;
c0117 = -0.01386893558480299100;
c0118 = 0.02065438521449612300;
c0119 = -0.01369359429808920100;
c0120 = 0.01363940939623843600;
c0121 = -0.00044559239205522550;
c0122 = 0.00300339160307345080;
c0123 = -0.00753526501092547600;
c0124 = 0.00883349863340078710;
c0125 = -0.00484506865769818160;

% Polinomio
d = c0070.*x1 + c0105.*x2 + c0120.*x3 + c0125.*x4 + c0001.*x1.^5 + c0005.*x1.^4 + c0015.*x1.^3 + c0035.*x1.^2 + c0071.*x2.^5 + c0074.*x2.^4 + c0080.*x2.^3 + c0090.*x2.^2 + c0106.*x3.^5 + c0108.*x3.^4 + c0111.*x3.^3 + c0115.*x3.^2 + c0121.*x4.^5 + c0122.*x4.^4 + c0123.*x4.^3 + c0124.*x4.^2 + c0002.*x1.^4.*x2 + c0003.*x1.^4.*x3 + c0004.*x1.^4.*x4 + c0009.*x1.^3.*x2 + c0012.*x1.^3.*x3 + c0014.*x1.^3.*x4 + c0025.*x1.^2.*x2 + c0031.*x1.^2.*x3 + c0034.*x1.^2.*x4 + c0036.*x1.*x2.^4 + c0039.*x1.*x2.^3 + c0045.*x1.*x2.^2 + c0056.*x1.*x3.^4 + c0058.*x1.*x3.^3 + c0061.*x1.*x3.^2 + c0066.*x1.*x4.^4 + c0067.*x1.*x4.^3 + c0068.*x1.*x4.^2 + c0072.*x2.^4.*x3 + c0073.*x2.^4.*x4 + c0077.*x2.^3.*x3 + c0079.*x2.^3.*x4 + c0086.*x2.^2.*x3 + c0089.*x2.^2.*x4 + c0091.*x2.*x3.^4 + c0093.*x2.*x3.^3 + c0096.*x2.*x3.^2 + c0101.*x2.*x4.^4 + c0102.*x2.*x4.^3 + c0103.*x2.*x4.^2 + c0107.*x3.^4.*x4 + c0110.*x3.^3.*x4 + c0114.*x3.^2.*x4 + c0116.*x3.*x4.^4 + c0117.*x3.*x4.^3 + c0118.*x3.*x4.^2 + c0006.*x1.^3.*x2.^2 + c0010.*x1.^3.*x3.^2 + c0013.*x1.^3.*x4.^2 + c0016.*x1.^2.*x2.^3 + c0019.*x1.^2.*x2.^2 + c0026.*x1.^2.*x3.^3 + c0028.*x1.^2.*x3.^2 + c0032.*x1.^2.*x4.^3 + c0033.*x1.^2.*x4.^2 + c0075.*x2.^3.*x3.^2 + c0078.*x2.^3.*x4.^2 + c0081.*x2.^2.*x3.^3 + c0083.*x2.^2.*x3.^2 + c0087.*x2.^2.*x4.^3 + c0088.*x2.^2.*x4.^2 + c0109.*x3.^3.*x4.^2 + c0112.*x3.^2.*x4.^3 + c0113.*x3.^2.*x4.^2 + c0055.*x1.*x2 + c0065.*x1.*x3 + c0069.*x1.*x4 + c0100.*x2.*x3 + c0104.*x2.*x4 + c0119.*x3.*x4 + c0051.*x1.*x2.*x3 + c0054.*x1.*x2.*x4 + c0064.*x1.*x3.*x4 + c0099.*x2.*x3.*x4 + c0007.*x1.^3.*x2.*x3 + c0008.*x1.^3.*x2.*x4 + c0011.*x1.^3.*x3.*x4 + c0022.*x1.^2.*x2.*x3 + c0024.*x1.^2.*x2.*x4 + c0030.*x1.^2.*x3.*x4 + c0037.*x1.*x2.^3.*x3 + c0038.*x1.*x2.^3.*x4 + c0042.*x1.*x2.^2.*x3 + c0044.*x1.*x2.^2.*x4 + c0046.*x1.*x2.*x3.^3 + c0048.*x1.*x2.*x3.^2 + c0052.*x1.*x2.*x4.^3 + c0053.*x1.*x2.*x4.^2 + c0057.*x1.*x3.^3.*x4 + c0060.*x1.*x3.^2.*x4 + c0062.*x1.*x3.*x4.^3 + c0063.*x1.*x3.*x4.^2 + c0076.*x2.^3.*x3.*x4 + c0085.*x2.^2.*x3.*x4 + c0092.*x2.*x3.^3.*x4 + c0095.*x2.*x3.^2.*x4 + c0097.*x2.*x3.*x4.^3 + c0098.*x2.*x3.*x4.^2 + c0017.*x1.^2.*x2.^2.*x3 + c0018.*x1.^2.*x2.^2.*x4 + c0020.*x1.^2.*x2.*x3.^2 + c0023.*x1.^2.*x2.*x4.^2 + c0027.*x1.^2.*x3.^2.*x4 + c0029.*x1.^2.*x3.*x4.^2 + c0040.*x1.*x2.^2.*x3.^2 + c0043.*x1.*x2.^2.*x4.^2 + c0059.*x1.*x3.^2.*x4.^2 + c0082.*x2.^2.*x3.^2.*x4 + c0084.*x2.^2.*x3.*x4.^2 + c0094.*x2.*x3.^2.*x4.^2 + c0021.*x1.^2.*x2.*x3.*x4 + c0041.*x1.*x2.^2.*x3.*x4 + c0047.*x1.*x2.*x3.^2.*x4 + c0049.*x1.*x2.*x3.*x4.^2 + c0050.*x1.*x2.*x3.*x4;
end